<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Japan Perl Association CPAN和訳ドキュメント">
<meta name="keyword" content="perl,cpan,jpa,和訳,日本語訳">
<title>Moose::Manual::Delegation Moose(0.79) - Japan Perl Association ドキュメント和訳プロジェクト</title>
<link rel="stylesheet" type="text/css" href="http://lazy-css.org/css/style.css" />
</head>
<body>
<h1>Moose::Manual::Delegation</h1>
<div class="path" id="path"><a href="/">HOME</a> &gt; <strong>Moose::Manual::Delegation</strong></div><div class="pod">
<!-- INDEX START -->

<ul class="list-index"><li><a href="#">題名</a></li>
<li><a href="#-2">委譲とはなにか</a></li>
<li><a href="#-3">マッピングを定義する</a></li>
<li><a href="#-4">アトリビュートが見つからない場合</a></li>
<li><a href="#-5">作者</a></li>
<li><a href="#COPYRIGHT_AND_LICENSE">COPYRIGHT AND LICENSE</a>
</li>
</ul><!-- INDEX END -->

<h2 id="">題名</h2>
<div id="CONTENT">
<p>Moose::Manual::Delegation - アトリビュートの委譲</p>

</div>
<h2 id="-2">委譲とはなにか</h2>
<div id="CONTENT-2">
<p>委譲というのは、アトリビュートの別のメソッドを呼ぶだけという「影のような」メソッドを作成できるようにする機能です。この非常に便利な機能を使うと、複雑な「has-a」の関係を単純化して、APIをひとつのクラスに統合してしまうことができるようになります。</p>
<p>また、委譲を使うと、クラスを使う側はそのクラスが持つすべてのオブジェクトを知る必要がなくなるので、覚えなければならないAPIの数も減ります。</p>
<p>委譲の定義は、「本当の」クラス（委譲元のクラス）が提供するひとつ以上のメソッドと、移譲先のクラスに用意するメソッドのマッピングという形で行います。移譲先のクラスでは、委譲元のクラスが提供するメソッド名を再利用することもできますし、独自の名前を用意することもできます。</p>
<p>また、委譲は、既存のクラス（特に、Mooseを使っていないクラスや、サブクラスしづらい（あるいはできない）クラス）をラップするときにも便利です。</p>

</div>
<h2 id="-3">マッピングを定義する</h2>
<div id="CONTENT-3">
<p>Mooseは委譲のマッピングを定義するために、簡単なものから複雑なものまで、さまざまなオプションを提供しています。</p>
<p>もっとも簡単なのは、単にメソッドのリストを指定する方法です。</p>
<pre>  package Website;

  use Moose;

  has 'uri' =&gt; (
      is      =&gt; 'ro',
      isa     =&gt; 'URI',
      handles =&gt; [qw( host path )],
  );

</pre>
<p>こう定義しておくと、<code>$website-&gt;host</code>を呼べば「とにかく動きます」（裏では、Mooseが<code>$website-&gt;uri-&gt;host</code>を呼んでくれます）。</p>
<p>ハッシュリファレンスを使ってマッピングを定義することもできます。こうすると、マッピングの一部でメソッドをリネームできるようになります。</p>
<pre>  package Website;

  use Moose;

  has 'uri' =&gt; (
      is      =&gt; 'ro',
      isa     =&gt; 'URI',
      handles =&gt; {
          hostname =&gt; 'host',
          path     =&gt; 'path',
      },
  );

</pre>
<p>この例では<code>URI.pm</code>の<code>host</code>というメソッド名を使うかわりに、<code>$website-&gt;hostname</code>というメソッドを作成しています。</p>
<p>この2つがもっともよく使うマッピングです。残りの方法はもう少し複雑で、あまり一般的でもありません。</p>
<pre>  has 'uri' =&gt; (
      is      =&gt; 'ro',
      isa     =&gt; 'URI',
      handles =&gt; qr/^(?:host|path|query.*)/,
  );

</pre>
<p>これは配列の場合と似ていますが、正規表現を使って委譲元が提供しているすべてのメソッドに対してマッチするか調べる点が異なります。これを正しく動作させるためには、アトリビュートの<code>isa</code>パラメータを指定しなければなりません、また、そのパラメータはクラスでなければなりません。Mooseはこのパラメータを利用して委譲元のクラスのイントロスペクションを行い、どんなメソッドを提供しているか判断します。</p>
<p><code>handles</code>の値にはロールの名前を使うこともできます。</p>
<pre>  has 'uri' =&gt; (
      is      =&gt; 'ro',
      isa     =&gt; 'URI',
      handles =&gt; 'HasURI',
  );

</pre>
<p>Mooseはこのロールのイントロスペクションを行ってどんなメソッドを提供しているか判断し、そのそれぞれのメソッドについてマッピングを生成します。</p>
<p>最後に、マッピングを「生成」するサブルーチンリファレンスを指定することもできます。おそらくこのバージョンを使う必要は（あったとしても）めったにないでしょうが、実際にどう動作するのかについての詳細は<cite>Moose</cite>のドキュメントをご覧ください。</p>

</div>
<h2 id="-4">アトリビュートが見つからない場合</h2>
<div id="CONTENT-4">
<p>必須でなかったり未定義になりうるアトリビュートのメソッドを委譲すること自体はまったく問題ありませんが、委譲したメソッドが呼ばれたときにアトリビュートにオブジェクトが入っていなかった場合は実行時エラーが発生します。</p>

</div>
<h2 id="-5">作者</h2>
<div id="CONTENT-5">
<p>Dave Rolsky &lt;autarch@urth.org&gt;</p>

</div>
<h2 id="COPYRIGHT_AND_LICENSE">COPYRIGHT AND LICENSE</h2>
<div id="COPYRIGHT_AND_LICENSE_CONTENT">
<p>Copyright 2009 by Infinity Interactive, Inc.</p>
<p><a href="http://www.iinteractive.com">http://www.iinteractive.com</a></p>
<p>This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.</p>

</div>
</div>
<div class="head">
	<div class="logo">
	<img src="http://lazy-css.org/css/img/logo.png">
	</div>
	<ul class="global-navi">

	<li><img src="http://lazy-css.org/css/img/g_home.png" alt="ホーム"></li>
	<li><img src="http://lazy-css.org/css/img/g_news.png" alt="ニュース"></li>
	<li><img src="http://lazy-css.org/css/img/g_blog.png" alt="ブログ"></li>
	</ul>
</div>
<ul class="sub-navi">
<li><img src="http://lazy-css.org/css/img/inq.png" alt="お問い合わせ"></li>
</ul>

<div class="footer">
<ul class="footer-navi">
	<li>リンク</li>
	<li>リンク</li>
	<li>リンク</li>
	<li>リンク</li>
</ul>
<address>&copy; copyright 2009 jpa all right reserved.</address>
</div>
</body>
</html>


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Moose::Manual::MooseX Moose(0.79) - Japan Perl Association ドキュメント和訳プロジェクト</title>
<link rel="stylesheet" type="text/css" href="http://lazy-css.org/css/style.css" />
</head>
<body>
<h1>Moose::Manual::MooseX</h1>
<div class="path" id="path"><a href="/">HOME</a> &gt; <a href="/Moose/Manual/MooseX.html">Moose::Manual::MooseX</a></div><div class="pod">
<!-- INDEX START -->

<ul class="list-index"><li><a href="#">題名</a></li>
<li><a href="#MooseX">MooseX?</a></li>
<li><a href="#cite_MooseX_AttributeHelpers_cite"><cite>MooseX::AttributeHelpers</cite></a></li>
<li><a href="#cite_MooseX_StrictConstructor_cite"><cite>MooseX::StrictConstructor</cite></a></li>
<li><a href="#cite_MooseX_Params_Validate_cite"><cite>MooseX::Params::Validate</cite></a></li>
<li><a href="#cite_MooseX_Getopt_cite"><cite>MooseX::Getopt</cite></a></li>
<li><a href="#cite_MooseX_Singleton_cite"><cite>MooseX::Singleton</cite></a></li>
<li><a href="#-2">検討中の拡張モジュール</a>
<ul>
<li>
<ul><li><a href="#cite_MooseX_Declare_cite"><cite>MooseX::Declare</cite></a></li>
<li><a href="#cite_MooseX_Types_cite"><cite>MooseX::Types</cite></a></li>
<li><a href="#cite_MooseX_Types_Structured_cite"><cite>MooseX::Types::Structured</cite></a></li>
<li><a href="#cite_MooseX_ClassAttribute_cite"><cite>MooseX::ClassAttribute</cite></a></li>
<li><a href="#cite_MooseX_Daemonize_cite"><cite>MooseX::Daemonize</cite></a></li>
<li><a href="#cite_MooseX_Role_Parameterized_cite"><cite>MooseX::Role::Parameterized</cite></a></li>
<li><a href="#cite_MooseX_POE_cite"><cite>MooseX::POE</cite></a></li>
<li><a href="#cite_MooseX_FollowPBP_cite"><cite>MooseX::FollowPBP</cite></a></li>
<li><a href="#cite_MooseX_SemiAffordanceAccessor_c"><cite>MooseX::SemiAffordanceAccessor</cite></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#-3">作者</a></li>
<li><a href="#COPYRIGHT_AND_LICENSE">COPYRIGHT AND LICENSE</a>
</li>
</ul><!-- INDEX END -->

<h2 id="">題名</h2>
<div id="CONTENT">
<p>Moose::Manual::MooseX - おすすめの拡張モジュール</p>

</div>
<h2 id="MooseX">MooseX?</h2>
<div id="MooseX_CONTENT">
<p>Mooseを拡張したり変更するのは簡単です（だからこそMooseはこれほど強力なのです）。MOPのAPIを使えば、独自のやり方で処理を行ったり、新しい機能を追加したり、一般的なカスタマイズを行うこともできます。</p>
<p>ただし、独自の拡張モジュールを書く場合は、メタモデルをよく理解しておく必要があります。まずは<cite>Moose::Manual::MOP</cite>のドキュメントをご覧ください。<cite>Moose::Cookbook</cite>にもいくつか拡張のためのレシピがあります。</p>
<p>拡張モジュールの書き方を説明するのはこのマニュアルの範囲を超えますが、ありがたいことに、すでに多くの人が拡張モジュールを書いてCPANにあげてくれています。</p>
<p>このドキュメントは、その中から私たちがもっとも愛用しているいくつかのモジュールを取り上げます。</p>

</div>
<h2 id="cite_MooseX_AttributeHelpers_cite"><cite>MooseX::AttributeHelpers</cite></h2>
<div id="cite_MooseX_AttributeHelpers_cite_CO">
<p>拡張モジュールをひとつしか見ないのであれば、これを見るべきです。これは、配列リファレンスやハッシュリファレンス、数、文字列といったPerlのネイティブなデータ型すべてに委譲に相当するものを用意します。</p>
<p>これを使うと、はるかにきれいで流れるようなAPIを作成できるようになります。</p>
<pre>  package User;

  use Moose;
  use MooseX::AttributeHelpers;

  has '_orders' =&gt; (
      metaclass =&gt; 'Collection::Array',
      is        =&gt; 'ro',
      isa       =&gt; 'ArrayRef',
      default   =&gt; sub { [] },
      provides  =&gt; {
          push     =&gt; 'add_order',
          shift    =&gt; 'next_order',
          elements =&gt; 'orders',
      },
  );

</pre>
<p>ここでは配列リファレンスをそのままさらすかわりに、わかりやすい名前のついた使いやすいメソッドを3つ用意しました。</p>

</div>
<h2 id="cite_MooseX_StrictConstructor_cite"><cite>MooseX::StrictConstructor</cite></h2>
<div id="cite_MooseX_StrictConstructor_cite_C">
<p>Mooseは、デフォルトでは余計な引数があってもすべてクラスのコンストラクタに渡してしまいますが、<cite>MooseX::StrictConstructor</cite>をロードすると、コンストラクタが認識できない引数があったときはエラーが発生するようになります。</p>
<pre>  package User;

  use Moose;
  use MooseX::StrictConstructor;

  has 'name';
  has 'email';

  User-&gt;new( name =&gt; 'Bob', emali =&gt; 'bob@example.com' );

</pre>
<p><cite>MooseX::StrictConstructor</cite>を使うと、「emali」というタイポのせいで実行時エラーが発生します（素のMooseの場合、「emali」アトリビュートは黙って無視されます）。</p>

</div>
<h2 id="cite_MooseX_Params_Validate_cite"><cite>MooseX::Params::Validate</cite></h2>
<div id="cite_MooseX_Params_Validate_cite_CON">
<p><cite>MooseX::Method::Signatures</cite>と<cite>MooseX::Declare</cite>の未来には大きな期待を寄せていますが、いまは、はるかに見劣りのする（ただし、速くて簡単な）<cite>MooseX::Params::Validate</cite>の方をおすすめします。このモジュールを使うと、Mooseの型や型変換をあらゆるメソッドの引数に適用できます。</p>
<pre>  package User;

  use Moose;
  use MooseX::Params::Validate;

  sub login {
      my $self = shift;
      my ($password)
          = validated_list( \@_, password =&gt; { isa =&gt; 'Str', required =&gt; 1 } );

      ...
  }

</pre>

</div>
<h2 id="cite_MooseX_Getopt_cite"><cite>MooseX::Getopt</cite></h2>
<div id="cite_MooseX_Getopt_cite_CONTENT">
<p>これは<code>new_with_options</code>というメソッドをクラスに追加してくれるロールです。これはコマンドラインオプションを受け取ってアトリビュートに値を入れてくれるコンストラクタです。</p>
<p>これを使うとコマンドラインアプリケーション用のモジュールを書くのが非常に簡単になります。</p>
<pre>  package App::Foo;

  use Moose;
  with 'MooseX::Getopt';

  has 'input' =&gt; (
      is       =&gt; 'ro',
      isa      =&gt; 'Str',
      required =&gt; 1
  );

  has 'output' =&gt; (
      is       =&gt; 'ro',
      isa      =&gt; 'Str',
      required =&gt; 1
  );

  sub run { ... }

</pre>
<p>実行したいスクリプトの方にはこう書いておきます。</p>
<pre>  use App::Foo;

  App::Foo-&gt;new_with_options-&gt;run;

</pre>
<p>これで、コマンドラインからこんな風にスクリプトを実行できるようになります。</p>
<pre>  foo@example&gt; foo --input /path/to/input --output /path/to/output

</pre>

</div>
<h2 id="cite_MooseX_Singleton_cite"><cite>MooseX::Singleton</cite></h2>
<div id="cite_MooseX_Singleton_cite_CONTENT">
<p>正直にいうと、シングルトンを使うのはハックにすぎないことも多いのですが、たしかにこれは便利なハックです。<cite>MooseX::Singleton</cite>を使うとMooseのクラスをシングルトンにできます。</p>
<pre>  package Config;

  use MooseX::Singleton; # instead of Moose

  has 'cache_dir' =&gt; ( ... );

</pre>
<p>こんなに簡単。</p>

</div>
<h2 id="-2">検討中の拡張モジュール</h2>
<div id="CONTENT-2">
<p>CPANには文字通り何ダースもの拡張モジュールがありますが、ここでは、便利に思う人もいるかもしれないけれど、まだお墨付きをあげられるほどではない拡張モジュールを紹介します。</p>

</div>
<h3 id="cite_MooseX_Declare_cite"><cite>MooseX::Declare</cite></h3>
<div id="cite_MooseX_Declare_cite_CONTENT">
<p>これは<code>Devel::Declare</code>を使って、PerlそのものをMooseベースのキーワードで拡張しようというものです。非常にクールな拡張モジュールですが、まだ新しい、実験段階のものです。</p>
<pre>  class User {

      has 'name'  =&gt; ( ... );
      has 'email' =&gt; ( ... );

      method login (Str $password) { ... }
  }

</pre>

</div>
<h3 id="cite_MooseX_Types_cite"><cite>MooseX::Types</cite></h3>
<div id="cite_MooseX_Types_cite_CONTENT">
<p>この拡張モジュールを使うと、アプリケーション用の型ライブラリを作成しやすくなります。また、あらかじめ型の名前を宣言しておくことで、裸のワードとして利用できるようになります。</p>
<pre>  use MooseX::Types -declare =&gt; ['PositiveInt'];
  use MooseX::Types::Moose 'Int';

  subtype PositiveInt
      =&gt; as Int,
      =&gt; where { $_ &gt; 0 }
      =&gt; message {&quot;Int is not larger than 0&quot;};

</pre>
<p>ありがたいことにこの裸の名前はMooseの型レジストリの中では実は名前空間がついているので、アプリケーションによって型の定義が異なる場合でも、同じ裸の名前を使うことができます。</p>

</div>
<h3 id="cite_MooseX_Types_Structured_cite"><cite>MooseX::Types::Structured</cite></h3>
<div id="cite_MooseX_Types_Structured_cite_CO">
<p>この拡張モジュールは、<cite>MooseX::Types</cite>をベースに、複雑なデータ構造を持つ型を宣言できるようにします。</p>
<pre>  use MooseX::Types -declare =&gt; [ qw( Name Color ) ];
  use MooseX::Types::Moose qw(Str Int);
  use MooseX::Types::Structured qw(Dict Tuple Optional);

  subtype Name
      =&gt; as Dict[ first =&gt; Str, middle =&gt; Optional[Str], last =&gt; Str ];

  subtype Color
      =&gt; as Tuple[ Int, Int, Int, Optional[Int] ];

</pre>
<p>もちろんオブジェクトを使えばいつでもこのようなことをすることはできます。</p>

</div>
<h3 id="cite_MooseX_ClassAttribute_cite"><cite>MooseX::ClassAttribute</cite></h3>
<div id="cite_MooseX_ClassAttribute_cite_CONT">
<p>この拡張モジュールは、Mooseのクラスにクラスアトリビュートを提供します。このモジュールを使って宣言したクラスアトリビュートは、通常のMooseのアトリビュートとまったく同じようにイントロスペクションできます。</p>
<pre>  package User;

  use Moose;
  use MooseX::ClassAttribute;

  has 'name' =&gt; ( ... );

  class_has 'Cache' =&gt; ( ... );

</pre>

</div>
<h3 id="cite_MooseX_Daemonize_cite"><cite>MooseX::Daemonize</cite></h3>
<div id="cite_MooseX_Daemonize_cite_CONTENT">
<p>これは起動や停止、PIDファイルの管理、シグナル処理といった、デーモンを作成するときに便利なさまざまなメソッドを提供するロールです。</p>

</div>
<h3 id="cite_MooseX_Role_Parameterized_cite"><cite>MooseX::Role::Parameterized</cite></h3>
<div id="cite_MooseX_Role_Parameterized_cite_">
<p>ロールを取り込む相手にあわせてカスタマイズしたい場合は、このツールがうってつけです。このモジュールを使うと、それぞれの相手にあわせてカスタマイズしたパラメータを受け取ってアトリビュートやメソッドなどを生成するロールを作成できます。</p>

</div>
<h3 id="cite_MooseX_POE_cite"><cite>MooseX::POE</cite></h3>
<div id="cite_MooseX_POE_cite_CONTENT">
<p>これはMooseのクラスと<code>POE::Session</code>を結びつける小さなラッパです。また、<code>event</code>というイベントハンドラを宣言するためのシュガー関数を提供しています。</p>

</div>
<h3 id="cite_MooseX_FollowPBP_cite"><cite>MooseX::FollowPBP</cite></h3>
<div id="cite_MooseX_FollowPBP_cite_CONTENT">
<p>『Perlベストプラクティス』風に、すべてのアクセサの名前を自動的に「get_size」や「set_size」のようにします。</p>

</div>
<h3 id="cite_MooseX_SemiAffordanceAccessor_c"><cite>MooseX::SemiAffordanceAccessor</cite></h3>
<div id="cite_MooseX_SemiAffordanceAccessor_c-2">
<p>すべてのアクセサの名前を自動的に「size」や「set_size」のように、getは明示せず、setは明示するようにします。</p>

</div>
<h2 id="-3">作者</h2>
<div id="CONTENT-3">
<p>Dave Rolsky &lt;autarch@urth.org&gt;</p>

</div>
<h2 id="COPYRIGHT_AND_LICENSE">COPYRIGHT AND LICENSE</h2>
<div id="COPYRIGHT_AND_LICENSE_CONTENT">
<p>Copyright 2009 by Infinity Interactive, Inc.</p>
<p><a href="http://www.iinteractive.com">http://www.iinteractive.com</a></p>
<p>This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.</p>

</div>
</div>
<div class="head">
	<div class="logo">
	<img src="http://lazy-css.org/css/img/logo.png">
	</div>
	<ul class="global-navi">

	<li><img src="http://lazy-css.org/css/img/g_home.png" alt="ホーム"></li>
	<li><img src="http://lazy-css.org/css/img/g_news.png" alt="ニュース"></li>
	<li><img src="http://lazy-css.org/css/img/g_blog.png" alt="ブログ"></li>
	</ul>
</div>
<ul class="sub-navi">
<li><img src="http://lazy-css.org/css/img/inq.png" alt="お問い合わせ"></li>
</ul>

<div class="footer">
<ul class="footer-navi">
	<li>リンク</li>
	<li>リンク</li>
	<li>リンク</li>
	<li>リンク</li>
</ul>
<address>&copy; copyright 2009 jpa all right reserved.</address>
</div>
</body>
</html>


<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf8" />
<title>Moose::Cookbook::Meta::Recipe4 Moose(0.79) - Japan Perl Association ドキュメント和訳プロジェクト</title>
<link rel="stylesheet" type="text/css" href="http://lazy-css.org/css/style.css">
</head>
<body>
<h1>Moose::Cookbook::Meta::Recipe4</h1>
<div class="pod">
<!-- INDEX START -->
<h3 id="TOP">Index</h3>

<ul><li><a href="#">題名</a></li>
<li><a href="#-2">概要</a></li>
<li><a href="#-3">本文</a></li>
<li><a href="#-4">メタクラス</a>
<ul>
<li>
<ul><li><a href="#-5">実際にこのメタクラスを使ってみる</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#-6">まとめ</a></li>
<li><a href="#-7">参照</a></li>
<li><a href="#-8">作者</a></li>
<li><a href="#COPYRIGHT_AND_LICENSE">COPYRIGHT AND LICENSE</a>
</li>
</ul><hr />
<!-- INDEX END -->

<h2 id="">題名</h2>
<div id="CONTENT">
<p>Moose::Cookbook::Meta::Recipe4 - メタクラスに「table」アトリビュートを追加する</p>

</div>
<h2 id="-2">概要</h2>
<div id="CONTENT-2">
<pre>  package MyApp::Meta::Class;
  use Moose;
  extends 'Moose::Meta::Class';

  has table =&gt; (
      is  =&gt; 'rw',
      isa =&gt; 'Str',
  );

</pre>

</div>
<h2 id="-3">本文</h2>
<div id="CONTENT-3">
<p>このレシピでは「table」アトリビュートを持つ新しいメタクラスを作成します。このメタクラスはORMを作るときのように、DBMSのテーブルに紐づけられたクラスに使うためのものです。</p>
<p>この例ではテーブル名は単なる文字列ですが、本当のORMであればそのテーブルを表すオブジェクトが入るかもしれません。</p>

</div>
<h2 id="-4">メタクラス</h2>
<div id="CONTENT-4">
<p>これは<a href="#SYNOPSIS">SYNOPSIS</a>にある通り本当に簡単なレシピですが、自分のクラスにこのメタクラスを使わせるのと、テーブルを宣言するためのシュガー関数を用意するのにこつがいります。これについては<cite>Moose::Cookbook::Extending::Recipe2</cite>で扱います（そちらではモジュールを<code>Moose.pm</code>自身のようにする方法や、<code>has_table()</code>のようなシュガー関数を用意する方法を紹介しています）。</p>

</div>
<h3 id="-5">実際にこのメタクラスを使ってみる</h3>
<div id="CONTENT-5">
<p>この新しい<code>table</code>アトリビュートにアクセスする方法はきわめて簡単。<code>MyApp::User</code>という名前のクラスがあるとしたら、このように書くだけです。</p>
<pre>  my $table = MyApp::User-&gt;meta-&gt;table;

</pre>
<p><code>MyApp::User</code>がメタクラスに<code>MyApp::Meta::Class</code>を使うようになっている限り、このメソッド呼び出しはうまくいきます。もっと慎重にいきたいのであれば、メタクラスのクラスをチェックすることもできます。</p>
<pre>  $table = MyApp::User-&gt;meta-&gt;table
      if MyApp::User-&gt;meta-&gt;isa('MyApp::Meta::Class');

</pre>

</div>
<h2 id="-6">まとめ</h2>
<div id="CONTENT-6">
<p>独自のメタクラスを作るのはむずかしいことではありません。独自のメタクラスを使うのはもう少し大変ですが、それについてはほかのレシピで取り上げます。また、これからクラスのメタクラスにトレートを組み込む話もしていきます。こちらはさらに柔軟で相性のよい実装になります。</p>

</div>
<h2 id="-7">参照</h2>
<div id="CONTENT-7">
<p><cite>Moose::Cookbook::Meta::Recipe5</cite> - 「table」アトリビュートをメタクラスのトレートとして実装する</p>
<p><cite>Moose::Cookbook::Extending::Recipe4</cite> - Moose.pmのようにMoose風のシュガー関数を提供する</p>

</div>
<h2 id="-8">作者</h2>
<div id="CONTENT-8">
<p>Dave Rolsky &lt;autarch@urth.org&gt;</p>

</div>
<h2 id="COPYRIGHT_AND_LICENSE">COPYRIGHT AND LICENSE</h2>
<div id="COPYRIGHT_AND_LICENSE_CONTENT">
<p>Copyright 2006-2009 by Infinity Interactive, Inc.</p>
<p><a href="http://www.iinteractive.com">http://www.iinteractive.com</a></p>
<p>This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.</p>

</div>
</div>
<div class="head">
	<div class="logo">
	<img src="http://lazy-css.org/css/img/logo.png">
	</div>
	<ul class="global-navi">

	<li><img src="http://lazy-css.org/css/img/g_home.png" alt="ホーム"></li>
	</ul>
</div>

<div class="footer">
<ul class="footer-navi">
	<li>リンク</li>
	<li>リンク</li>
	<li>リンク</li>

	<li>リンク</li>
</ul>
<address>&copy; copyright 2009 jpa all right reserved.</address>

</body>
</html>

